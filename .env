UI_DEBUG_WORKERS=1
POLL_SECS=2

# Step 1 optional reporting (not used in signatures)
WITH_MASSPROPS=1
DEFAULT_DENSITY_KG_M3=7850
MASSPROPS_DEBUG=0


# Meshing (Step 2)
PREVIEW_MESH_DEFLECTION=50
FULL_MESH_DEFLECTION=999999  # effectively disable full if you kept it
MAX_ASSEMBLY_STL_MB=20
PREFLIGHT_TARGET_STL_MB=80
PREFLIGHT_MAX_STL_MB=200
PREFLIGHT_DEFLECTION_START=150
PREFLIGHT_DEFLECTION_MAX=1200
PREFLIGHT_DEFLECTION_ITERS=4
PREFLIGHT_BIG_STEP_MB=50
PREFLIGHT_KEEP_STL_MAX_MB=20
PREFLIGHT_RENDER_MAX_FACES=250000
PREFLIGHT_HLR_MAX_EDGES=40000
PREFLIGHT_HLR_SAMPLES_PER_EDGE=14
PREFLIGHT_STL_DEFLECTION_BIG_FALLBACK=1200

# --- common run folder layout ---
RUNS_DIR=/app/ui_runs
STATUS_REL=status.json
PROGRESS_REL=progress.log

# --- run layout filenames (shared by ui + workers) ---
PREFLIGHT_PACK_REL=preflight_pack.json
ORIENTATION_REL=orientation.json
XCAF_INSTANCES_REL=xcaf_instances.json
ASSETS_MANIFEST_REL=assets_manifest.json
OCC_TREE_REL=occ_tree.json
ANALYSIS_PACK_REL=analysis_pack.json

# --- stl export worker ---
WORKER_SLEEP_SEC=2.0
STL_EXPORT_TRIGGER_STAGES=ready
STL_EXPORT_HEARTBEAT_SEC=10.0

# exporter command template
EXPORT_STL_CMD=python /repo/export_stl_xcaf.py --step-path "{step}" --out-dir "{out}" --xcaf-json "{xcaf}"

# pass-through for exporter
STL_LINEAR_DEFLECTION=0.8
STL_ANGULAR_DEFLECTION=0.2
STL_ASCII=0

# exporter robustness
STL_WRITE_RETRIES=3
STL_WRITE_RETRY_SCALE=2.0
STL_WRITE_RETRY_SLEEP_SEC=0.0
STL_WRITE_MIN_BYTES=256

# Explode

EXPLODE_PLAN_REL=explode_plan.json
EXPLODE_DAEMON_POLL_SEC=2.0
EXPLODE_DAEMON_MAX_RUNS_PER_TICK=10
EXPLODE_TIMEOUT_SEC=0
PATCH_TIMEOUT_SEC=0

# Part-id bbox quantization (Step 1 + Step 2 must match)
BBOX_TOL_MM=0.1

# Default behavior
USE_SIG_FREE=1
SKIP_CHIRALITY=0

#brep_signature debug
SIG_DEBUG=0

# Optional simple material overrides (substring match)
DENSITY_STAINLESS_KG_M3=8000
DENSITY_ALUMINIUM_KG_M3=2700
DENSITY_GALV_KG_M3=7850
STEP4_STEEL_DENSITY_MIN=7000
STEP4_STEEL_DENSITY_MAX=8500

# step 4

# Generate unknown gallery by default (optional)
STEP4_UNKNOWN_GALLERY=1
STEP4_UNKNOWN_GALLERY_MAX=800

# Step 4 plate detection
STEP4_PLATE_THICK_MAX_MM=30
STEP4_PLATE_THIN_RATIO=0.10
STEP4_PLATE_MIN_SPAN_MM=50

# Step 4 geometry fallback
STEP4_SECTION_LEN_RATIO=4.0
STEP4_HARDWARE_MAX_DIM_MM=200
STEP4_HARDWARE_MAX_MASS_KG=5

# Step 4 grating detection (mass-based)
# solidity = (actual kg/m2) / (solid plate kg/m2 at same thickness)
# lower => more open => grating-like
STEP4_GRATING_SOLIDITY_MAX=0.55


#UI Step3_1

STEP3_1_TOL_MM=0.5
STEP3_1_MAX_PTS=8000
STEP3_1_ALLOW_REFLECTION=1
STEP3_1_DEBUG=0

# Classifier

CAT_PLATE_THK_MAX_MM=30
CAT_PLATE_A_OVER_C_MIN=10
CAT_PLATE_B_OVER_C_MIN=6

CAT_PLATE_THK_MAX_MM_HEAVY=75
CAT_PLATE_A_OVER_C_MIN_HEAVY=10
CAT_PLATE_B_OVER_C_MIN_HEAVY=10

CAT_SECTION_A_OVER_B_MIN=6
CAT_SECTION_A_OVER_C_MIN=6

# --- Step 4.1 bom_flat worker ---

BOM_GLOBAL_REL=bom_global_exploded.json
PARTS_INDEX_REL=parts_index.json
CATEGORIES_REL=categories.json
BOM_FLAT_REL=bom_flat.json

BOM_FLAT_DAEMON_MAX_RUNS_PER_TICK=40
BOM_FLAT_DAEMON_MAX_DIR_SCAN=20000
BOM_FLAT_MAX_BOM_ROWS=300000
BOM_FLAT_MAX_OUT_ROWS=200000
BOM_FLAT_MAX_MEMBER_SIGS_PER_ROW=40
BOM_FLAT_MAX_WHERE_USED_PER_ROW=40

BOM_FLAT_DAEMON_STATE_FILENAME=_bom_flat_state.json
BOM_FLAT_DAEMON_LOCK_FILENAME=_bom_flat.lock
BOM_FLAT_DAEMON_LOG=_bom_flat_daemon.log
